#include <stdio.h>
#include <stdlib.h>

int main(void)
{
	printf("Double free with tcache\n");
	
	// fastbin
	printf("\n[Fastbin] without tcache, it would corrupt (double free or corruption)\n");
	void *m1 = malloc(0x20);
	free(m1);
	free(m1);
	printf(" 1st fast chunk allocation : %p\n", malloc(0x20));
	printf(" 2nd fast chunk allocation : %p\n", malloc(0x20));

	// smallbin
	printf("\n[Smallbin] without tcache, it would corrupt (double free or corruption)\n");
	void *m2 = malloc(0xc0);
	free(m2);
	free(m2);
	printf(" 1st small chunk allocation : %p\n", malloc(0xc0));
	printf(" 2nd small chunk allocation : %p\n", malloc(0xc0));
	return 0;
}
